# Generated by Django 4.2.8 on 2025-10-10 22:49

from django.conf import settings
from django.db import migrations, models
import django.db.models.deletion
import django.utils.timezone


class Migration(migrations.Migration):

    initial = True

    dependencies = [
        migrations.swappable_dependency(settings.AUTH_USER_MODEL),
    ]

    operations = [
        migrations.CreateModel(
            name='UserProfile',
            fields=[
                ('id', models.BigAutoField(auto_created=True, primary_key=True, serialize=False, verbose_name='ID')),
                ('firebase_uid', models.CharField(blank=True, db_index=True, max_length=128, null=True)),
                ('user_type', models.IntegerField(choices=[(0, 'Yük Veren'), (1, 'Taşıyıcı')], default=0, help_text='Kullanıcı tipi: Yük Veren veya Taşıyıcı')),
                ('phone_number', models.CharField(blank=True, help_text='Telefon numarası', max_length=20)),
                ('iban', models.CharField(blank=True, help_text='IBAN numarası (TR ile başlayan)', max_length=34)),
                ('company_name', models.CharField(blank=True, help_text='Şirket adı (opsiyonel)', max_length=200)),
                ('tax_id', models.CharField(blank=True, help_text='Vergi/TC Kimlik Numarası', max_length=20)),
                ('billing_address', models.TextField(blank=True, help_text='Fatura adresi')),
                ('service_areas', models.TextField(blank=True, help_text='Hizmet verilen şehirler (virgülle ayrılmış)')),
                ('working_hours', models.CharField(blank=True, default='09:00-18:00', help_text='Çalışma saatleri', max_length=100)),
                ('bio', models.TextField(blank=True, help_text='Taşıyıcı hakkında (max 500 karakter)', max_length=500)),
                ('rating_avg', models.DecimalField(decimal_places=2, default=0.0, help_text='Ortalama puan', max_digits=3)),
                ('rating_count', models.IntegerField(default=0, help_text='Toplam değerlendirme sayısı')),
                ('profile_completed', models.BooleanField(default=False)),
                ('documents_verified', models.BooleanField(default=False)),
                ('created_at', models.DateTimeField(auto_now_add=True)),
                ('updated_at', models.DateTimeField(auto_now=True)),
                ('user', models.OneToOneField(on_delete=django.db.models.deletion.CASCADE, related_name='profile', to=settings.AUTH_USER_MODEL)),
            ],
            options={
                'verbose_name': 'Kullanıcı Profili',
                'verbose_name_plural': 'Kullanıcı Profilleri',
            },
        ),
        migrations.CreateModel(
            name='Vehicle',
            fields=[
                ('id', models.BigAutoField(auto_created=True, primary_key=True, serialize=False, verbose_name='ID')),
                ('plate_number', models.CharField(help_text='Plaka numarası (34 ABC 123)', max_length=20, unique=True)),
                ('brand', models.CharField(help_text='Marka (Mercedes, Ford, vb)', max_length=100)),
                ('model', models.CharField(help_text='Model', max_length=100)),
                ('year', models.IntegerField(help_text='Yıl')),
                ('vehicle_type', models.IntegerField(choices=[(0, 'Kamyonet'), (1, 'Kamyon'), (2, 'TIR'), (3, 'Çekici'), (4, 'Dorse')], default=0)),
                ('max_weight_kg', models.IntegerField(help_text='Maksimum yük kapasitesi (kg)')),
                ('max_volume_m3', models.DecimalField(decimal_places=2, help_text='Maksimum hacim (m³)', max_digits=5)),
                ('has_cargo_insurance', models.BooleanField(default=False, help_text='Nakliye sigortası var mı?')),
                ('insurance_company', models.CharField(blank=True, max_length=100)),
                ('insurance_expiry', models.DateField(blank=True, help_text='Sigorta bitiş tarihi', null=True)),
                ('is_active', models.BooleanField(default=True)),
                ('created_at', models.DateTimeField(auto_now_add=True)),
                ('updated_at', models.DateTimeField(auto_now=True)),
                ('carrier_profile', models.ForeignKey(on_delete=django.db.models.deletion.CASCADE, related_name='vehicles', to='website.userprofile')),
            ],
            options={
                'verbose_name': 'Araç',
                'verbose_name_plural': 'Araçlar',
                'ordering': ['-created_at'],
            },
        ),
        migrations.CreateModel(
            name='ShipmentApproval',
            fields=[
                ('id', models.BigAutoField(auto_created=True, primary_key=True, serialize=False, verbose_name='ID')),
                ('shipment_id', models.CharField(db_index=True, help_text='Firestore Document ID', max_length=128, unique=True)),
                ('tracking_number', models.CharField(db_index=True, help_text='YN-2025-001234', max_length=50)),
                ('shipper_uid', models.CharField(help_text='Yük sahibi Firebase UID', max_length=128)),
                ('shipper_email', models.EmailField(max_length=254)),
                ('title', models.CharField(max_length=255)),
                ('from_address', models.CharField(max_length=500)),
                ('to_address', models.CharField(max_length=500)),
                ('suggested_price', models.DecimalField(decimal_places=2, max_digits=10)),
                ('status', models.CharField(choices=[('pending', 'Onay Bekliyor'), ('approved', 'Onaylandı'), ('rejected', 'Reddedildi')], default='pending', max_length=20)),
                ('created_at', models.DateTimeField(default=django.utils.timezone.now)),
                ('approved_at', models.DateTimeField(blank=True, null=True)),
                ('rejection_reason', models.TextField(blank=True)),
                ('notes', models.TextField(blank=True, help_text='Admin notları')),
                ('approved_by', models.ForeignKey(blank=True, null=True, on_delete=django.db.models.deletion.SET_NULL, to=settings.AUTH_USER_MODEL)),
            ],
            options={
                'verbose_name': 'İlan Onayı',
                'verbose_name_plural': 'İlan Onayları',
                'ordering': ['-created_at'],
            },
        ),
        migrations.CreateModel(
            name='Shipment',
            fields=[
                ('shipment_id', models.CharField(db_index=True, help_text='Unique ID', max_length=128, primary_key=True, serialize=False, unique=True)),
                ('tracking_number', models.CharField(db_index=True, help_text='YN-2025-001234', max_length=50, unique=True)),
                ('shipper_uid', models.CharField(db_index=True, help_text='Firebase UID', max_length=128)),
                ('shipper_email', models.EmailField(max_length=254)),
                ('shipper_phone', models.CharField(max_length=20)),
                ('title', models.CharField(help_text='İlan başlığı', max_length=255)),
                ('description', models.TextField(help_text='İlan açıklaması')),
                ('cargo_type', models.CharField(choices=[('evden_eve', 'Evden Eve Nakliyat'), ('isyeri', 'İş Yeri Taşıma'), ('parcali', 'Parçalı Eşya'), ('arac', 'Araç Taşıma'), ('beyaz_esya', 'Beyaz Eşya'), ('mobilya', 'Mobilya'), ('diger', 'Diğer')], default='diger', max_length=50)),
                ('from_address_city', models.CharField(max_length=100)),
                ('from_address_district', models.CharField(max_length=100)),
                ('from_address_full', models.TextField()),
                ('from_address_lat', models.DecimalField(blank=True, decimal_places=7, max_digits=10, null=True)),
                ('from_address_lng', models.DecimalField(blank=True, decimal_places=7, max_digits=10, null=True)),
                ('to_address_city', models.CharField(max_length=100)),
                ('to_address_district', models.CharField(max_length=100)),
                ('to_address_full', models.TextField()),
                ('to_address_lat', models.DecimalField(blank=True, decimal_places=7, max_digits=10, null=True)),
                ('to_address_lng', models.DecimalField(blank=True, decimal_places=7, max_digits=10, null=True)),
                ('weight', models.DecimalField(decimal_places=2, help_text='Ağırlık (kg)', max_digits=10)),
                ('volume', models.DecimalField(blank=True, decimal_places=2, help_text='Hacim (m³)', max_digits=10, null=True)),
                ('suggested_price', models.DecimalField(decimal_places=2, help_text='Önerilen fiyat (TRY)', max_digits=10)),
                ('final_price', models.DecimalField(blank=True, decimal_places=2, help_text='Kesinleşen fiyat', max_digits=10, null=True)),
                ('pickup_date', models.DateField(help_text='Teslim alma tarihi')),
                ('delivery_date', models.DateField(blank=True, help_text='Teslimat tarihi', null=True)),
                ('images', models.JSONField(blank=True, default=list, help_text='Yük fotoğrafları (URL listesi)')),
                ('status', models.CharField(choices=[('active', 'Aktif'), ('assigned', 'Atandı'), ('in_transit', 'Yolda'), ('completed', 'Tamamlandı'), ('cancelled', 'İptal')], default='active', max_length=20)),
                ('assigned_carrier_uid', models.CharField(blank=True, help_text='Atanan taşıyıcı UID', max_length=128)),
                ('assigned_bid_id', models.CharField(blank=True, help_text='Kabul edilen teklif ID', max_length=128)),
                ('view_count', models.IntegerField(default=0, help_text='Görüntülenme sayısı')),
                ('bid_count', models.IntegerField(default=0, help_text='Teklif sayısı')),
                ('created_at', models.DateTimeField(default=django.utils.timezone.now)),
                ('updated_at', models.DateTimeField(auto_now=True)),
                ('completed_at', models.DateTimeField(blank=True, null=True)),
                ('shipper', models.ForeignKey(help_text='Yük sahibi', on_delete=django.db.models.deletion.CASCADE, related_name='shipments', to='website.userprofile')),
            ],
            options={
                'verbose_name': 'İlan',
                'verbose_name_plural': 'İlanlar',
                'ordering': ['-created_at'],
            },
        ),
        migrations.CreateModel(
            name='Bid',
            fields=[
                ('bid_id', models.CharField(db_index=True, help_text='Unique ID', max_length=128, primary_key=True, serialize=False, unique=True)),
                ('tracking_number', models.CharField(db_index=True, help_text='İlan takip numarası', max_length=50)),
                ('carrier_uid', models.CharField(db_index=True, help_text='Taşıyıcı Firebase UID', max_length=128)),
                ('carrier_email', models.EmailField(max_length=254)),
                ('carrier_name', models.CharField(blank=True, max_length=255)),
                ('carrier_phone', models.CharField(blank=True, max_length=20)),
                ('carrier_verified', models.BooleanField(default=False, help_text='Taşıyıcı belgeleri onaylı mı?')),
                ('shipper_uid', models.CharField(help_text='Yük sahibi Firebase UID', max_length=128)),
                ('shipper_email', models.EmailField(max_length=254)),
                ('offered_price', models.DecimalField(decimal_places=2, help_text='Teklif edilen fiyat (TRY)', max_digits=10)),
                ('estimated_delivery_days', models.IntegerField(default=1, help_text='Tahmini teslimat günü')),
                ('message', models.TextField(blank=True, help_text='Taşıyıcının mesajı')),
                ('shipper_comment', models.TextField(blank=True, help_text='Yük sahibinin yanıt mesajı')),
                ('status', models.CharField(choices=[('pending', 'Beklemede'), ('accepted', 'Kabul Edildi'), ('rejected', 'Reddedildi'), ('withdrawn', 'Geri Çekildi')], default='pending', max_length=20)),
                ('created_at', models.DateTimeField(default=django.utils.timezone.now)),
                ('updated_at', models.DateTimeField(auto_now=True)),
                ('accepted_at', models.DateTimeField(blank=True, null=True)),
                ('shipment', models.ForeignKey(help_text='İlan', on_delete=django.db.models.deletion.CASCADE, related_name='bids', to='website.shipment')),
            ],
            options={
                'verbose_name': 'Teklif',
                'verbose_name_plural': 'Teklifler',
                'ordering': ['-created_at'],
            },
        ),
        migrations.CreateModel(
            name='AdminActivity',
            fields=[
                ('id', models.BigAutoField(auto_created=True, primary_key=True, serialize=False, verbose_name='ID')),
                ('action_type', models.CharField(choices=[('document_approved', 'Belge Onaylandı'), ('document_rejected', 'Belge Reddedildi'), ('shipment_approved', 'İlan Onaylandı'), ('shipment_rejected', 'İlan Reddedildi'), ('user_suspended', 'Kullanıcı Askıya Alındı'), ('user_activated', 'Kullanıcı Aktif Edildi')], max_length=50)),
                ('target_type', models.CharField(help_text='user, document, shipment', max_length=50)),
                ('target_id', models.CharField(max_length=128)),
                ('description', models.TextField()),
                ('timestamp', models.DateTimeField(default=django.utils.timezone.now)),
                ('ip_address', models.GenericIPAddressField(blank=True, null=True)),
                ('admin_user', models.ForeignKey(on_delete=django.db.models.deletion.CASCADE, to=settings.AUTH_USER_MODEL)),
            ],
            options={
                'verbose_name': 'Admin Aktivitesi',
                'verbose_name_plural': 'Admin Aktiviteleri',
                'ordering': ['-timestamp'],
            },
        ),
        migrations.CreateModel(
            name='UserDocument',
            fields=[
                ('id', models.BigAutoField(auto_created=True, primary_key=True, serialize=False, verbose_name='ID')),
                ('firebase_uid', models.CharField(db_index=True, help_text='Firebase User UID', max_length=128)),
                ('user_email', models.EmailField(help_text='Kullanıcı email', max_length=254)),
                ('user_name', models.CharField(blank=True, max_length=255)),
                ('document_type', models.CharField(choices=[('license', 'Ehliyet'), ('registration', 'Ruhsat'), ('src', 'SRC Belgesi'), ('psychotech', 'Psikoteknik Raporu')], max_length=20)),
                ('document_url', models.URLField(help_text='Firebase Storage URL')),
                ('status', models.CharField(choices=[('pending', 'Onay Bekliyor'), ('approved', 'Onaylandı'), ('rejected', 'Reddedildi')], default='pending', max_length=20)),
                ('uploaded_at', models.DateTimeField(default=django.utils.timezone.now)),
                ('verified_at', models.DateTimeField(blank=True, null=True)),
                ('rejection_reason', models.TextField(blank=True, help_text='Reddedilme sebebi')),
                ('notes', models.TextField(blank=True, help_text='Admin notları')),
                ('verified_by', models.ForeignKey(blank=True, null=True, on_delete=django.db.models.deletion.SET_NULL, to=settings.AUTH_USER_MODEL)),
            ],
            options={
                'verbose_name': 'Kullanıcı Belgesi',
                'verbose_name_plural': 'Kullanıcı Belgeleri',
                'ordering': ['-uploaded_at'],
                'indexes': [models.Index(fields=['firebase_uid', 'document_type'], name='website_use_firebas_a682e2_idx'), models.Index(fields=['status'], name='website_use_status_e50eb3_idx')],
            },
        ),
        migrations.AddIndex(
            model_name='shipment',
            index=models.Index(fields=['shipper_uid', 'status'], name='website_shi_shipper_2d5194_idx'),
        ),
        migrations.AddIndex(
            model_name='shipment',
            index=models.Index(fields=['status', '-created_at'], name='website_shi_status_14abf3_idx'),
        ),
        migrations.AddIndex(
            model_name='shipment',
            index=models.Index(fields=['tracking_number'], name='website_shi_trackin_412cf2_idx'),
        ),
        migrations.AddIndex(
            model_name='shipment',
            index=models.Index(fields=['from_address_city', 'to_address_city'], name='website_shi_from_ad_3b497e_idx'),
        ),
        migrations.AddIndex(
            model_name='bid',
            index=models.Index(fields=['shipment_id', 'status'], name='website_bid_shipmen_658646_idx'),
        ),
        migrations.AddIndex(
            model_name='bid',
            index=models.Index(fields=['carrier_uid', 'status'], name='website_bid_carrier_49e6de_idx'),
        ),
        migrations.AddIndex(
            model_name='bid',
            index=models.Index(fields=['tracking_number'], name='website_bid_trackin_124abb_idx'),
        ),
    ]
